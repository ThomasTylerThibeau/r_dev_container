## 1.) confirm all 500 orders have a first scoop
fiveHunFirstScoop =
  "
    SELECT 
      count(Scoop1)
    
    FROM 
      orders o
  "

sqldf(fiveHunFirstScoop)


## 2.) site names by sales, descending
mostSales =
  "
    SELECT 
      l.City,
      Count(o.ID) as TotalOrders
    
    From 
      orders o
    
    Join 
        locations l On o.Site = l.ID
    
    Group By 
        l.City
    
    Order By 
        TotalOrders Desc
  "

sqldf(mostSales)


## 3.) number of each customer's purchases, by name not number
timesVisited = 
  "
    SELECT
      o.Customer,
      c.Fname,
      c.Lname,
      COUNT(o.ID) AS visits
    
    FROM
      orders o
    
    JOIN
      customers c ON o.Customer = c.ID
    
    GROUP BY
      o.Customer, c.Fname, c.Lname
    
    ORDER BY
      visits DESC
  "

sqldf(timesVisited)


## 4.) which ice creams &/ toppings contain nuts
nutty = 
  "
    SELECT ID, Flavor AS Name, 'Flavor' AS Type
    FROM flavors
    WHERE Nuts = 'Y'
    
    UNION
    
    SELECT ID, Name, 'Topping' AS Type
    FROM toppings
    WHERE Nuts = 'Y';
  "


sqldf(nutty)